<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyze basket trial using Cunanan et al. efficient design — analyze_basket.cunanan • metabasket</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze basket trial using Cunanan et al. efficient design — analyze_basket.cunanan"><meta name="description" content="Implements the efficient basket trial design from Cunanan et al. (2017) that
uses an interim assessment of heterogeneity via Fisher's exact test to determine
whether to pool baskets for increased power or analyze them separately."><meta property="og:description" content="Implements the efficient basket trial design from Cunanan et al. (2017) that
uses an interim assessment of heterogeneity via Fisher's exact test to determine
whether to pool baskets for increased power or analyze them separately."><meta property="og:image" content="https://tgerke.github.io/metabasket/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metabasket</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to metabasket</a></li>
    <li><a class="dropdown-item" href="../articles/design_comparison.html">Comparing Basket Trial Designs</a></li>
    <li><a class="dropdown-item" href="../articles/drug_combination_trial.html">Drug Combination Trial: A Practical Example</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/tgerke/metabasket" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyze basket trial using Cunanan et al. efficient design</h1>
      <small class="dont-index">Source: <a href="https://github.com/tgerke/metabasket/blob/main/R/method_cunanan.R" class="external-link"><code>R/method_cunanan.R</code></a></small>
      <div class="d-none name"><code>analyze_basket.cunanan.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the efficient basket trial design from Cunanan et al. (2017) that
uses an interim assessment of heterogeneity via Fisher's exact test to determine
whether to pool baskets for increased power or analyze them separately.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'cunanan'</span></span>
<span><span class="fu"><a href="analyze_basket.html">analyze_basket</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">design</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">0.52</span>,</span>
<span>  alpha_s <span class="op">=</span> <span class="fl">0.07</span>,</span>
<span>  alpha_c <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  interim_data <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>basket_data</code> object containing the trial data</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>A <code>basket_design</code> object containing the design specifications</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (not currently used, for S3 consistency)</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>Tuning parameter for heterogeneity assessment (0-1). Higher values
favor heterogeneous design path. Default is 0.52 based on K=5 baskets.</p></dd>


<dt id="arg-alpha-s">alpha_s<a class="anchor" aria-label="anchor" href="#arg-alpha-s"></a></dt>
<dd><p>Significance level for separate analyses in heterogeneous path,
before correction for multiple comparisons. Default is 0.07.</p></dd>


<dt id="arg-alpha-c">alpha_c<a class="anchor" aria-label="anchor" href="#arg-alpha-c"></a></dt>
<dd><p>Significance level for combined analysis in homogeneous path.
Default is 0.05.</p></dd>


<dt id="arg-interim-data">interim_data<a class="anchor" aria-label="anchor" href="#arg-interim-data"></a></dt>
<dd><p>Optional <code>basket_data</code> object with stage 1 results. If NULL,
assumes <code>data</code> represents stage 1.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class "cunanan_result" containing:</p><ul><li><p><code>rejections</code>: Logical vector indicating rejected baskets</p></li>
<li><p><code>p_values</code>: P-values for each basket</p></li>
<li><p><code>toh_pvalue</code>: P-value from test of homogeneity (Fisher's exact test)</p></li>
<li><p><code>design_path</code>: Either "heterogeneous" or "homogeneous"</p></li>
<li><p><code>continued_baskets</code>: Baskets that continued to stage 2</p></li>
<li><p><code>test_statistics</code>: Additional test statistics</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Cunanan design has two stages:</p>
<p><strong>Stage 1</strong>: Enroll n1 patients per basket. Conduct Fisher's exact test on the
K x 2 contingency table of responses/non-responses across baskets.</p>
<p><strong>Decision at interim</strong>:</p><ul><li><p>If p-value &lt;= gamma: Evidence of heterogeneity → heterogeneous path</p><ul><li><p>Continue only baskets with &gt;= 1 responder</p></li>
<li><p>Analyze each basket separately at end with Bonferroni correction (alpha_s/K*)</p></li>
</ul></li>
<li><p>If p-value &gt; gamma: Evidence of homogeneity → homogeneous path</p><ul><li><p>Continue all baskets if total responses &gt;= K (approximately 1 per basket)</p></li>
<li><p>Analyze pooled data at end with one-sample test (alpha_c)</p></li>
</ul></li>
</ul><p><strong>Stage 2</strong>: Additional patients enrolled according to path chosen</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cunanan KM, Iasonos A, Shen R, Begg CB, Gönen M (2017). An efficient basket
trial design. <em>Statistics in Medicine</em>, 36(10):1568-1579.
doi:10.1002/sim.7227</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Design for 5 baskets</span></span></span>
<span class="r-in"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="basket_design.html">basket_design</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n_baskets <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,  <span class="co"># Stage 1</span></span></span>
<span class="r-in"><span>  design_type <span class="op">=</span> <span class="st">"cunanan"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stage 1 data</span></span></span>
<span class="r-in"><span><span class="va">stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="basket_data.html">basket_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Basket"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Analyze</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">stage1</span>, <span class="va">design</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tgerke" class="external-link">Travis Gerke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

