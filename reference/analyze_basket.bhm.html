<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyze basket trial using Bayesian Hierarchical Model — analyze_basket.bhm • metabasket</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze basket trial using Bayesian Hierarchical Model — analyze_basket.bhm"><meta name="description" content="Wrapper for bhmbasket package implementing Bayesian hierarchical modeling
from Berry et al. (2013) and Neuenschwander et al. (2016).
This method uses MCMC sampling via JAGS to estimate posterior distributions
with hierarchical borrowing of information across baskets."><meta property="og:description" content="Wrapper for bhmbasket package implementing Bayesian hierarchical modeling
from Berry et al. (2013) and Neuenschwander et al. (2016).
This method uses MCMC sampling via JAGS to estimate posterior distributions
with hierarchical borrowing of information across baskets."><meta property="og:image" content="https://tgerke.github.io/metabasket/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metabasket</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to metabasket</a></li>
    <li><a class="dropdown-item" href="../articles/design_comparison.html">Comparing Basket Trial Designs</a></li>
    <li><a class="dropdown-item" href="../articles/drug_combination_trial.html">Drug Combination Trial: A Practical Example</a></li>
    <li><a class="dropdown-item" href="../articles/simon_designs.html">Simon Designs with metabasket</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/tgerke/metabasket" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Analyze basket trial using Bayesian Hierarchical Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/tgerke/metabasket/blob/main/R/method_bhm.R" class="external-link"><code>R/method_bhm.R</code></a></small>
      <div class="d-none name"><code>analyze_basket.bhm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wrapper for bhmbasket package implementing Bayesian hierarchical modeling
from Berry et al. (2013) and Neuenschwander et al. (2016).</p>
<p>This method uses MCMC sampling via JAGS to estimate posterior distributions
with hierarchical borrowing of information across baskets.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'bhm'</span></span>
<span><span class="fu"><a href="analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">design</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A basket_data object containing trial results</p></dd>


<dt id="arg-design">design<a class="anchor" aria-label="anchor" href="#arg-design"></a></dt>
<dd><p>A basket_design object with design_type = "bhm"</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently unused)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A bhm_result object containing:</p>
<dl><dt>posterior_means</dt>
<dd><p>Posterior mean response rates for each basket</p></dd>

<dt>posterior_probs</dt>
<dd><p>Posterior P(rate &gt; null_rate) for each basket</p></dd>

<dt>rejections</dt>
<dd><p>Logical vector of rejection decisions</p></dd>

<dt>basket_names</dt>
<dd><p>Names of baskets</p></dd>

<dt>method</dt>
<dd><p>Analysis method ("berry", "exnex", etc.)</p></dd>

<dt>threshold</dt>
<dd><p>Decision threshold used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>System Requirements:</strong> This method requires JAGS (Just Another Gibbs Sampler)
to be installed on your system. Install from <a href="https://mcmc-jags.sourceforge.io/" class="external-link">https://mcmc-jags.sourceforge.io/</a>.</p>
<p>The bhmbasket package provides several BHM methods:</p><ul><li><p>"berry": Berry et al. (2013) exchangeability model</p></li>
<li><p>"exnex": Neuenschwander et al. (2016) EX-NEX model</p></li>
<li><p>"exnex_adj": Combination approach</p></li>
<li><p>"pooled": Full pooling across baskets</p></li>
<li><p>"stratified": No pooling (independent analyses)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Berry SM, Broglio KR, Groshen S, Berry DA (2013). "Bayesian hierarchical modeling
of patient subpopulations: Efficient designs of Phase II oncology clinical trials."
Clinical Trials, 10(5), 720-734.</p>
<p>Neuenschwander B, Wandel S, Roychoudhury S, Bailey S (2016). "Robust exchangeability
designs for early phase clinical trials with multiple strata." Pharmaceutical
Statistics, 15(2), 123-134.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Note: Requires JAGS installation</span></span></span>
<span class="r-in"><span><span class="va">design_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="basket_design.html">basket_design</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  design_type <span class="op">=</span> <span class="st">"bhm"</span>,</span></span>
<span class="r-in"><span>  n_baskets <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  n_patients_per_basket <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  null_response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"berry"</span>,</span></span>
<span class="r-in"><span>    n_mcmc_iterations <span class="op">=</span> <span class="fl">5000</span>,</span></span>
<span class="r-in"><span>    evidence_level <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">data_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="basket_data.html">basket_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Basket A"</span>, <span class="st">"Basket B"</span>, <span class="st">"Basket C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">data_bhm</span>, <span class="va">design_bhm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_bhm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="extract_rejections.html">extract_rejections</a></span><span class="op">(</span><span class="va">result_bhm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tgerke" class="external-link">Travis Gerke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

