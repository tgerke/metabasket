<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to metabasket • metabasket</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to metabasket">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">metabasket</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction to metabasket</a></li>
    <li><a class="dropdown-item" href="../articles/design_comparison.html">Comparing Basket Trial Designs</a></li>
    <li><a class="dropdown-item" href="../articles/drug_combination_trial.html">Drug Combination Trial: A Practical Example</a></li>
    <li><a class="dropdown-item" href="../articles/simon_designs.html">Simon Designs with metabasket</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tgerke/metabasket" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to metabasket</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tgerke/metabasket/blob/main/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="d-none name"><code>introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tgerke.github.io/metabasket">metabasket</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="what-are-basket-trials">What are Basket Trials?<a class="anchor" aria-label="anchor" href="#what-are-basket-trials"></a>
</h2>
<p>Basket trials are a type of master protocol that evaluates a single
therapy across multiple cancer types or subtypes simultaneously. The
term “basket” refers to grouping patients with different cancers that
share a common molecular alteration or biomarker.</p>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li>
<strong>Single Treatment</strong>: All patients receive the same
investigational therapy</li>
<li>
<strong>Multiple Baskets</strong>: Each basket represents a
different cancer type or subtype</li>
<li>
<strong>Information Borrowing</strong>: Statistical methods can
borrow information across baskets to improve efficiency</li>
<li>
<strong>Efficiency</strong>: One protocol, one study team, faster
enrollment</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-trials">Example Trials<a class="anchor" aria-label="anchor" href="#example-trials"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Imatinib in Sarcomas</strong> (Chugh et al. 2009): Evaluated
imatinib across 10 sarcoma subtypes</li>
<li>
<strong>Vemurafenib in BRAF V600 Cancers</strong> (Hyman et
al. 2015): Tested vemurafenib in 6 non-melanoma cancers</li>
<li>
<strong>Larotrectinib in TRK Fusion Cancers</strong> (Drilon et
al. 2018): Studied TRK inhibitor across 12 cancer types</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="the-metabasket-package">The metabasket Package<a class="anchor" aria-label="anchor" href="#the-metabasket-package"></a>
</h2>
<p>The <code>metabasket</code> package provides a unified framework
for:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Designing</strong> basket trials with different statistical
methods</li>
<li>
<strong>Simulating</strong> trial data to evaluate operating
characteristics</li>
<li>
<strong>Analyzing</strong> basket trial data with consistent
interfaces</li>
<li>
<strong>Comparing</strong> different design approaches</li>
<li>
<strong>Generating</strong> protocol language for regulatory
submissions</li>
</ol>
</div>
<div class="section level2">
<h2 id="system-requirements">System Requirements<a class="anchor" aria-label="anchor" href="#system-requirements"></a>
</h2>
<p>Most methods in <code>metabasket</code> work out of the box. However,
the <strong>Bayesian Hierarchical Model (BHM)</strong> methods require
<strong>JAGS</strong> (Just Another Gibbs Sampler) to be installed on
your system.</p>
<div class="section level3">
<h3 id="installing-jags">Installing JAGS<a class="anchor" aria-label="anchor" href="#installing-jags"></a>
</h3>
<p><strong>macOS (using Homebrew):</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">brew</span> install jags</span></code></pre></div>
<p>After installing JAGS, the <code>rjags</code> R package may need
symlinks if Homebrew installed JAGS in <code>/opt/homebrew</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">sudo</span> mkdir <span class="at">-p</span> /usr/local/lib</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-sf</span> /opt/homebrew/Cellar/jags/<span class="pp">*</span>/lib/libjags.4.dylib /usr/local/lib/libjags.4.dylib</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">sudo</span> ln <span class="at">-sf</span> /opt/homebrew/Cellar/jags/<span class="pp">*</span>/lib/JAGS /usr/local/lib/JAGS</span></code></pre></div>
<p>Then install the R package:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rjags"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Windows:</strong></p>
<ol style="list-style-type: decimal">
<li>Download the JAGS installer from: <a href="https://mcmc-jags.sourceforge.io/" class="external-link uri">https://mcmc-jags.sourceforge.io/</a>
</li>
<li>Run the installer (choose appropriate 32-bit or 64-bit version)</li>
<li>Install the R package:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rjags"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Linux (Ubuntu/Debian):</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">sudo</span> apt-get install jags</span></code></pre></div>
<p>Then in R:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"rjags"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Verifying Installation:</strong></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mcmc-jags.sourceforge.io" class="external-link">rjags</a></span><span class="op">)</span></span>
<span><span class="co"># Should load without errors</span></span></code></pre></div>
<p>If BHM methods are not needed, all other methods (BMA, MEM, Simon,
Cunanan) work without JAGS.</p>
</div>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic Workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<div class="section level3">
<h3 id="define-a-basket-trial-design">1. Define a Basket Trial Design<a class="anchor" aria-label="anchor" href="#define-a-basket-trial-design"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a simple 4-basket design</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"bma"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Design</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: bma </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Basket Details:</span></span>
<span><span class="co">#&gt;    Basket  N Null_Rate Response_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25       0.2          0.35</span></span>
<span><span class="co">#&gt;      SCLC 25       0.2          0.35</span></span>
<span><span class="co">#&gt;  Melanoma 25       0.2          0.35</span></span>
<span><span class="co">#&gt;       RCC 25       0.2          0.35</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-trial-data">2. Simulate Trial Data<a class="anchor" aria-label="anchor" href="#simulate-trial-data"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate simulated trials</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_responses.html">simulate_responses</a></span><span class="op">(</span><span class="va">design</span>, n_sims <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at first simulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Data</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Basket  N Responses Response_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25         7          0.28</span></span>
<span><span class="co">#&gt;      SCLC 25        11          0.44</span></span>
<span><span class="co">#&gt;  Melanoma 25         8          0.32</span></span>
<span><span class="co">#&gt;       RCC 25        12          0.48</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Patients: 100 </span></span>
<span><span class="co">#&gt; Total Responses: 38 </span></span>
<span><span class="co">#&gt; Overall Response Rate: 0.38</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="analyze-data">3. Analyze Data<a class="anchor" aria-label="anchor" href="#analyze-data"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: These functions will be fully implemented with package integrations</span></span>
<span></span>
<span><span class="co"># Analyze a single trial</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">design</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run full simulation study</span></span>
<span><span class="va">sim_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_basket_trial.html">simulate_basket_trial</a></span><span class="op">(</span><span class="va">design</span>, n_sims <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View operating characteristics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim_results</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For large simulations, enable parallel processing for speedup</span></span>
<span><span class="co"># future::plan(future::multisession, workers = 4)</span></span>
<span><span class="co"># sim_results_parallel &lt;- simulate_basket_trial(design, n_sims = 5000, .parallelize = TRUE)</span></span>
<span><span class="co"># future::plan(future::sequential)  # Reset when done</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-real-data">Working with Real Data<a class="anchor" aria-label="anchor" href="#working-with-real-data"></a>
</h2>
<p>You can create basket data objects from real trial results:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Imatinib trial data (Chugh et al. 2009)</span></span>
<span><span class="va">imatinib_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Angiosarcoma"</span>, <span class="st">"Ewing"</span>, <span class="st">"Fibrosarcoma"</span>, <span class="st">"Leiomyosarcoma"</span>,</span>
<span>                   <span class="st">"Liposarcoma"</span>, <span class="st">"MFH"</span>, <span class="st">"Osteosarcoma"</span>, <span class="st">"MPNST"</span>,</span>
<span>                   <span class="st">"Rhabdomyosarcoma"</span>, <span class="st">"Synovial"</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">13</span>, <span class="fl">12</span>, <span class="fl">28</span>, <span class="fl">29</span>, <span class="fl">29</span>, <span class="fl">26</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">imatinib_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Data</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Baskets: 10 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Basket  N Responses Response_Rate</span></span>
<span><span class="co">#&gt;      Angiosarcoma 15         2         0.133</span></span>
<span><span class="co">#&gt;             Ewing 13         0         0.000</span></span>
<span><span class="co">#&gt;      Fibrosarcoma 12         1         0.083</span></span>
<span><span class="co">#&gt;    Leiomyosarcoma 28         6         0.214</span></span>
<span><span class="co">#&gt;       Liposarcoma 29         7         0.241</span></span>
<span><span class="co">#&gt;               MFH 29         3         0.103</span></span>
<span><span class="co">#&gt;      Osteosarcoma 26         5         0.192</span></span>
<span><span class="co">#&gt;             MPNST  5         1         0.200</span></span>
<span><span class="co">#&gt;  Rhabdomyosarcoma  2         0         0.000</span></span>
<span><span class="co">#&gt;          Synovial 20         3         0.150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Patients: 179 </span></span>
<span><span class="co">#&gt; Total Responses: 28 </span></span>
<span><span class="co">#&gt; Overall Response Rate: 0.156</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparing-design-methods">Comparing Design Methods<a class="anchor" aria-label="anchor" href="#comparing-design-methods"></a>
</h2>
<p>The package supports multiple statistical approaches:</p>
<div class="section level3">
<h3 id="bayesian-model-averaging-bma">Bayesian Model Averaging (BMA)<a class="anchor" aria-label="anchor" href="#bayesian-model-averaging-bma"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design_bma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span><span class="op">)</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"bma"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>BMA considers all possible partitions of baskets and averages results
across partitions weighted by their posterior probabilities.</p>
</div>
<div class="section level3">
<h3 id="multi-source-exchangeability-model-mem">Multi-source Exchangeability Model (MEM)<a class="anchor" aria-label="anchor" href="#multi-source-exchangeability-model-mem"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span><span class="op">)</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"mem"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>MEM dynamically learns which baskets are exchangeable based on
observed data.</p>
</div>
<div class="section level3">
<h3 id="bayesian-hierarchical-model-bhm">Bayesian Hierarchical Model (BHM)<a class="anchor" aria-label="anchor" href="#bayesian-hierarchical-model-bhm"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span><span class="op">)</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"bhm"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>BHM assumes basket response rates come from a common distribution,
enabling shrinkage estimation.</p>
</div>
</div>
<div class="section level2">
<h2 id="generating-protocol-language">Generating Protocol Language<a class="anchor" aria-label="anchor" href="#generating-protocol-language"></a>
</h2>
<p>The package can generate standardized protocol text:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">protocol_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_protocol_language.html">generate_protocol_language</a></span><span class="op">(</span></span>
<span>  <span class="va">design_bma</span>,</span>
<span>  include_statistical_details <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_references <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display protocol text</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">protocol_text</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Basket Trial Design</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Trial Overview</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This is a basket trial designed to evaluate the efficacy of [DRUG NAME] across 4 cancer types or subtypes. The trial will enroll patients into 4 distinct baskets based on their cancer diagnosis:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1. Basket_1 (N = 25 patients)</span></span>
<span><span class="co">#&gt; 2. Basket_2 (N = 25 patients)</span></span>
<span><span class="co">#&gt; 3. Basket_3 (N = 25 patients)</span></span>
<span><span class="co">#&gt; 4. Basket_4 (N = 25 patients)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The total sample size for this trial is 100 patients (25 patients per basket). This sample size was selected to provide adequate power to detect clinically meaningful treatment effects while accounting for information borrowing across baskets.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Statistical Methodology</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The trial will use a Bayesian Model Averaging for the analysis of treatment efficacy. The Bayesian model averaging (BMA) approach considers multiple possible partitions of the baskets, where baskets within the same partition are assumed to have identical response rates. The posterior probability of treatment efficacy in each basket is computed as a weighted average across all partitions, where the weights correspond to the posterior probabilities of the partitions given the observed data. This approach provides adaptive borrowing of information across baskets based on the similarity of their observed response rates.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; #### Technical Details</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior distributions will be placed on the response rates within each partition, and a prior will be specified over the space of all possible partitions. The posterior distribution will be computed using analytical or numerical methods, and decisions will be based on the posterior probability that the response rate exceeds the null rate in each basket.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Hypothesis Testing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For each basket j (j = 1, ..., 4), we will test the following hypotheses:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; H0: pi_j &lt;= 20.0% (the treatment is not efficacious)</span></span>
<span><span class="co">#&gt; H1: pi_j &gt; 20.0% (the treatment is efficacious)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; where pi_j represents the true response rate for basket j.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Decision Criteria</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; At the completion of enrollment, the posterior probability that H1 is true will be computed for each basket using the observed data and the specified statistical model. A basket will be declared promising (i.e., H0 will be rejected) if the posterior probability exceeds a prespecified threshold gamma.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The threshold gamma will be calibrated through simulation studies to achieve desired operating characteristics (e.g., family-wise error rate &lt;= 5%, adequate power). The final threshold will be specified in the Statistical Analysis Plan prior to unblinding.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Operating Characteristics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The design has been calibrated through simulation studies to maintain appropriate Type I error control while maximizing power to detect treatment effects. Detailed operating characteristics are available in the Statistical Analysis Plan.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## References</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1. Zhou T, Ji Y. Bayesian Methods for Information Borrowing in Basket Trials: An Overview. Cancers. 2024;16(2):251.</span></span>
<span><span class="co">#&gt; 2. Hobbs BP, Pestana RC, Zabor EC, Kaizer AM, Hong DS. Basket trials: Review of current practice and innovations for future trials. J Clin Oncol. 2022;40(28):3520-3528.</span></span>
<span><span class="co">#&gt; 3. Psioda MA, Xu J, Jiang Q, Ke C, Yang Z, Ibrahim JG. Bayesian adaptive basket trial design using model averaging. Biostatistics. 2021;22(1):19-34.</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export to file</span></span>
<span><span class="fu"><a href="../reference/export_protocol_language.html">export_protocol_language</a></span><span class="op">(</span><span class="va">design_bma</span>, file <span class="op">=</span> <span class="st">"basket_protocol.md"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="understanding-operating-characteristics">Understanding Operating Characteristics<a class="anchor" aria-label="anchor" href="#understanding-operating-characteristics"></a>
</h2>
<p>Key metrics for basket trials:</p>
<div class="section level3">
<h3 id="basket-specific-metrics">Basket-Specific Metrics<a class="anchor" aria-label="anchor" href="#basket-specific-metrics"></a>
</h3>
<ul>
<li>
<strong>Power</strong>: Probability of correctly identifying a
promising basket</li>
<li>
<strong>Type I Error</strong>: Probability of falsely declaring a
non-promising basket as promising</li>
</ul>
</div>
<div class="section level3">
<h3 id="family-wise-metrics">Family-Wise Metrics<a class="anchor" aria-label="anchor" href="#family-wise-metrics"></a>
</h3>
<ul>
<li>
<strong>FWER</strong>: Family-wise error rate (probability of ≥1
false positive)</li>
<li>
<strong>FWP-D</strong>: Disjunctive power (probability of detecting
≥1 promising basket)</li>
<li>
<strong>FWP-C</strong>: Conjunctive power (probability of detecting
all promising baskets)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="the-cunanan-efficient-design">The Cunanan Efficient Design<a class="anchor" aria-label="anchor" href="#the-cunanan-efficient-design"></a>
</h2>
<p>The Cunanan et al. (2017) design offers a frequentist alternative
with an adaptive two-stage approach:</p>
<div class="section level3">
<h3 id="key-features-1">Key Features<a class="anchor" aria-label="anchor" href="#key-features-1"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Interim Heterogeneity Test</strong>: Uses Fisher’s exact
test to assess homogeneity</li>
<li>
<strong>Two Design Paths</strong>:
<ul>
<li>
<strong>Heterogeneous Path</strong>: Analyze baskets separately with
Bonferroni correction</li>
<li>
<strong>Homogeneous Path</strong>: Pool all baskets for increased
power</li>
</ul>
</li>
<li>
<strong>Sample Size Efficiency</strong>: Can achieve high power with
fewer patients when treatment effect is homogeneous</li>
</ol>
</div>
<div class="section level3">
<h3 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Design for 5 baskets (Cunanan default parameters)</span></span>
<span><span class="va">design_cunanan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">5</span><span class="op">)</span>,  <span class="co"># Stage 1: 7 patients per basket</span></span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"cunanan"</span>,</span>
<span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    r_s <span class="op">=</span> <span class="fl">1</span>,      <span class="co"># Min responses to continue individual basket</span></span>
<span>    r_c <span class="op">=</span> <span class="fl">5</span>,      <span class="co"># Min total responses to continue all baskets</span></span>
<span>    n2 <span class="op">=</span> <span class="fl">15</span>,      <span class="co"># Stage 2 sample size per continuing basket</span></span>
<span>    gamma <span class="op">=</span> <span class="fl">0.52</span>, <span class="co"># Heterogeneity test threshold</span></span>
<span>    alpha_s <span class="op">=</span> <span class="fl">0.07</span>, <span class="co"># Separate analysis significance level</span></span>
<span>    alpha_c <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Combined analysis significance level</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stage 1 data (interim analysis)</span></span>
<span><span class="va">stage1_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Basket"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform interim analysis</span></span>
<span><span class="va">interim_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">stage1_data</span>, <span class="va">design_cunanan</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">interim_result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Continues to stage 2 based on interim result...</span></span>
<span><span class="co"># After collecting additional data:</span></span>
<span><span class="co"># final_data &lt;- basket_data(...)</span></span>
<span><span class="co"># final_result &lt;- analyze_basket(final_data, design_cunanan, </span></span>
<span><span class="co">#                                interim_data = interim_result)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-use-cunanan-design">When to Use Cunanan Design<a class="anchor" aria-label="anchor" href="#when-to-use-cunanan-design"></a>
</h3>
<p><strong>Advantages:</strong> - Frequentist framework (may be
preferred by some reviewers) - Explicit control of FWER at target level
- Efficient when treatment effect is homogeneous - Clear decision
rules</p>
<p><strong>Considerations:</strong> - Less power when effect is in only
1 basket - Requires two-stage implementation - Less flexible than
Bayesian approaches for complex borrowing</p>
</div>
</div>
<div class="section level2">
<h2 id="simon-two-stage-design-reference">Simon Two-Stage Design (Reference)<a class="anchor" aria-label="anchor" href="#simon-two-stage-design-reference"></a>
</h2>
<p>The Simon design serves as a reference comparator, analyzing each
basket independently:</p>
<div class="section level3">
<h3 id="key-features-2">Key Features<a class="anchor" aria-label="anchor" href="#key-features-2"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>No Information Borrowing</strong>: Each basket analyzed
separately</li>
<li>
<strong>Optimal or Minimax</strong>: Choose design that minimizes
expected N or maximum N</li>
<li>
<strong>Futility Stopping</strong>: Two-stage design with interim
futility check per basket</li>
<li>
<strong>FWER Control</strong>: Bonferroni correction across
baskets</li>
</ol>
</div>
<div class="section level3">
<h3 id="example-usage-1">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage-1"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parallel Simon designs for 4 baskets</span></span>
<span><span class="va">design_simon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"simon"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stage 1</span></span>
<span><span class="va">stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Basket"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interim analysis with Bonferroni correction</span></span>
<span><span class="va">interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">stage1</span>, <span class="va">design_simon</span>, </span>
<span>                         alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">/</span><span class="fl">4</span>,  <span class="co"># FWER control</span></span>
<span>                         beta <span class="op">=</span> <span class="fl">0.20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">interim</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare with basket designs</span></span>
<span><span class="co"># Basket designs typically require fewer patients due to information borrowing</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="when-to-use-simon-design">When to Use Simon Design<a class="anchor" aria-label="anchor" href="#when-to-use-simon-design"></a>
</h3>
<p><strong>Use as reference when:</strong> - Comparing efficiency of
basket designs - Conservative approach needed (no borrowing assumptions)
- Strong heterogeneity expected (borrowing inappropriate)</p>
<p><strong>Limitations:</strong> - Requires more patients than basket
designs when treatment is homogeneous - No adaptation based on
similarity across baskets - Conservative (may miss opportunities for
information sharing)</p>
</div>
</div>
<div class="section level2">
<h2 id="design-considerations">Design Considerations<a class="anchor" aria-label="anchor" href="#design-considerations"></a>
</h2>
<div class="section level3">
<h3 id="when-to-borrow-information">When to Borrow Information<a class="anchor" aria-label="anchor" href="#when-to-borrow-information"></a>
</h3>
<p>Information borrowing is beneficial when:</p>
<ul>
<li>Treatment response rates are expected to be similar across
baskets</li>
<li>Some baskets have small sample sizes</li>
<li>The mechanism of action suggests similar efficacy</li>
</ul>
<p>Be cautious when:</p>
<ul>
<li>Substantial heterogeneity is expected</li>
<li>Risk of inflated Type I error is unacceptable</li>
<li>Strong prior evidence suggests differential effects</li>
</ul>
</div>
<div class="section level3">
<h3 id="choosing-sample-sizes">Choosing Sample Sizes<a class="anchor" aria-label="anchor" href="#choosing-sample-sizes"></a>
</h3>
<p>Factors to consider:</p>
<ol style="list-style-type: decimal">
<li>Expected response rates under H0 and H1</li>
<li>Desired power and Type I error control</li>
<li>Degree of information borrowing</li>
<li>Prevalence of each cancer type</li>
<li>Enrollment feasibility</li>
</ol>
</div>
<div class="section level3">
<h3 id="setting-null-response-rates">Setting Null Response Rates<a class="anchor" aria-label="anchor" href="#setting-null-response-rates"></a>
</h3>
<p>The null rate (p0) typically represents:</p>
<ul>
<li>Historical response rate to standard of care</li>
<li>Minimum clinically interesting response rate</li>
<li>May vary by basket if standard of care differs</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>For more details, see these vignettes:</p>
<ul>
<li>
<code>vignette("simulation-studies")</code>: Conducting simulation
studies</li>
<li>
<code>vignette("method-comparison")</code>: Comparing statistical
methods</li>
<li>
<code>vignette("real-data-analysis")</code>: Analyzing published
basket trials</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Zhou T, Ji Y.</strong> Bayesian Methods for Information
Borrowing in Basket Trials: An Overview. <em>Cancers</em>.
2024;16(2):251.</p></li>
<li><p><strong>Hobbs BP, et al.</strong> Basket trials: Review of
current practice and innovations for future trials. <em>J Clin
Oncol</em>. 2022;40(28):3520-3528.</p></li>
<li><p><strong>Psioda MA, et al.</strong> Bayesian adaptive basket trial
design using model averaging. <em>Biostatistics</em>.
2021;22(1):19-34.</p></li>
<li><p><strong>Hobbs BP, Landin R.</strong> Bayesian basket trial design
with exchangeability monitoring. <em>Stat Med</em>.
2018;37(25):3557-3572.</p></li>
<li><p><strong>Berry SM, et al.</strong> Bayesian hierarchical modeling
of patient subpopulations: Efficient designs of phase II oncology
clinical trials. <em>Clin Trials</em>. 2013;10(5):720-734.</p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tgerke" class="external-link">Travis Gerke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
