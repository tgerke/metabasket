<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>metabasket - Unified Framework for Basket Trial Design • metabasket</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="metabasket - Unified Framework for Basket Trial Design">
<meta name="description" content="Provides a consistent interface for designing, simulating, and analyzing  basket trials using multiple established methods.
">
<meta property="og:description" content="Provides a consistent interface for designing, simulating, and analyzing  basket trials using multiple established methods.
">
<meta property="og:image" content="https://tgerke.github.io/metabasket/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">metabasket</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html" aria-label="Home"><span class="fa fas fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/introduction.html">Introduction to metabasket</a></li>
    <li><a class="dropdown-item" href="articles/design_comparison.html">Comparing Basket Trial Designs</a></li>
    <li><a class="dropdown-item" href="articles/drug_combination_trial.html">Drug Combination Trial: A Practical Example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tgerke/metabasket" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="metabasket-">metabasket 
<a class="anchor" aria-label="anchor" href="#metabasket-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><strong>metabasket</strong> provides a unified interface for designing, simulating, and analyzing basket trials using multiple established statistical methods. Basket trials evaluate a single therapy across multiple cancer types or subtypes simultaneously, and can benefit from information borrowing across baskets to improve efficiency and power.</p>
<p>The package wraps existing implementations and provides:</p>
<ul>
<li>
<strong>Consistent interface</strong> for comparing different basket trial designs</li>
<li>
<strong>Simulation framework</strong> for evaluating operating characteristics</li>
<li>
<strong>Protocol language generation</strong> for study documentation</li>
<li>
<strong>Benchmark testing</strong> against published results</li>
</ul>
</div>
<div class="section level2">
<h2 id="supported-methods">Supported Methods<a class="anchor" aria-label="anchor" href="#supported-methods"></a>
</h2>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">Method</th>
<th align="left">Package</th>
<th align="left">Reference</th>
<th align="left">Key Features</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Bayesian Model Averaging (BMA)</td>
<td align="left"><code>bmabasket</code></td>
<td align="left">Psioda et al. (2021)</td>
<td align="left">Averages over models with different basket partitions</td>
</tr>
<tr class="even">
<td align="left">Multi-source Exchangeability (MEM)</td>
<td align="left"><code>basket</code></td>
<td align="left">Hobbs &amp; Landin (2018), Kaizer et al. (2018)</td>
<td align="left">Learns basket exchangeability from data</td>
</tr>
<tr class="odd">
<td align="left">Bayesian Hierarchical Model (BHM)</td>
<td align="left"><code>bhmbasket</code></td>
<td align="left">Berry et al. (2013), Neuenschwander et al. (2016)</td>
<td align="left">Shrinks basket estimates toward global mean</td>
</tr>
<tr class="even">
<td align="left">Efficient Basket Design</td>
<td align="left">Native</td>
<td align="left">Cunanan et al. (2017)</td>
<td align="left">Two-stage design with interim heterogeneity test</td>
</tr>
<tr class="odd">
<td align="left">Simon Two-Stage</td>
<td align="left"><code>clinfun</code></td>
<td align="left">Simon (1989)</td>
<td align="left">Independent parallel designs (reference comparator)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tgerke/metabasket"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tgerke.github.io/metabasket">metabasket</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a basket trial design</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span><span class="op">)</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"cunanan"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the design</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Design</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: cunanan </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Basket Details:</span></span>
<span><span class="co">#&gt;    Basket  N Null_Rate Response_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25       0.2          0.35</span></span>
<span><span class="co">#&gt;      SCLC 25       0.2          0.35</span></span>
<span><span class="co">#&gt;  Melanoma 25       0.2          0.35</span></span>
<span><span class="co">#&gt;       RCC 25       0.2          0.35</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate trial data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simulate_responses.html">simulate_responses</a></span><span class="op">(</span><span class="va">design</span>, n_sims <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at first simulation</span></span>
<span><span class="va">sims</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Basket Trial Data</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Basket  N Responses Response_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25         7          0.28</span></span>
<span><span class="co">#&gt;      SCLC 25        11          0.44</span></span>
<span><span class="co">#&gt;  Melanoma 25         8          0.32</span></span>
<span><span class="co">#&gt;       RCC 25        12          0.48</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Patients: 100 </span></span>
<span><span class="co">#&gt; Total Responses: 38 </span></span>
<span><span class="co">#&gt; Overall Response Rate: 0.38</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate protocol language</span></span>
<span><span class="va">protocol_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/generate_protocol_language.html">generate_protocol_language</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">protocol_text</span><span class="op">)</span></span>
<span><span class="co">#&gt; # Basket Trial Design</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Trial Overview</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; This is a basket trial designed to evaluate the efficacy of [DRUG NAME] across 4 cancer types or subtypes. The trial will enroll patients into 4 distinct baskets based on their cancer diagnosis:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1. NSCLC (N = 25 patients)</span></span>
<span><span class="co">#&gt; 2. SCLC (N = 25 patients)</span></span>
<span><span class="co">#&gt; 3. Melanoma (N = 25 patients)</span></span>
<span><span class="co">#&gt; 4. RCC (N = 25 patients)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The total sample size for this trial is 100 patients (25 patients per basket). This sample size was selected to provide adequate power to detect clinically meaningful treatment effects while accounting for information borrowing across baskets.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Statistical Methodology</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The trial will use a Efficient Basket Trial Design for the analysis of treatment efficacy. This design uses a two-stage approach with an interim analysis to assess homogeneity of treatment effects across baskets. If substantial heterogeneity is not detected, data are pooled across baskets for increased efficiency. Otherwise, each basket is analyzed independently to avoid inappropriate borrowing of information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; #### Technical Details</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The interim analysis uses Fisher's exact test to assess homogeneity. The critical value for the test statistic is chosen to optimize operating characteristics through simulation. The final analysis threshold is adjusted based on whether pooling or stratified analysis is used.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Hypothesis Testing</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; For each basket j (j = 1, ..., 4), we will test the following hypotheses:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; H0: pi_j &lt;= 20.0% (the treatment is not efficacious)</span></span>
<span><span class="co">#&gt; H1: pi_j &gt; 20.0% (the treatment is efficacious)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; where pi_j represents the true response rate for basket j.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ### Decision Criteria</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; At the completion of enrollment, the posterior probability that H1 is true will be computed for each basket using the observed data and the specified statistical model. A basket will be declared promising (i.e., H0 will be rejected) if the posterior probability exceeds a prespecified threshold gamma.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The threshold gamma will be calibrated through simulation studies to achieve desired operating characteristics (e.g., family-wise error rate &lt;= 5%, adequate power). The final threshold will be specified in the Statistical Analysis Plan prior to unblinding.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## Operating Characteristics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The design has been calibrated through simulation studies to maintain appropriate Type I error control while maximizing power to detect treatment effects. Detailed operating characteristics are available in the Statistical Analysis Plan.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ## References</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1. Zhou T, Ji Y. Bayesian Methods for Information Borrowing in Basket Trials: An Overview. Cancers. 2024;16(2):251.</span></span>
<span><span class="co">#&gt; 2. Hobbs BP, Pestana RC, Zabor EC, Kaizer AM, Hong DS. Basket trials: Review of current practice and innovations for future trials. J Clin Oncol. 2022;40(28):3520-3528.</span></span>
<span><span class="co">#&gt; 3. Cunanan KM, Iasonos A, Shen R, Begg CB, Gonen M. An efficient basket trial design. Stat Med. 2017;36(10):1568-1579.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cunanan-efficient-design">Cunanan Efficient Design<a class="anchor" aria-label="anchor" href="#cunanan-efficient-design"></a>
</h2>
<p>The Cunanan design uses a two-stage adaptive approach with an interim test of homogeneity:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Design for 5 baskets</span></span>
<span><span class="va">design_cunanan</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,  <span class="co"># Stage 1</span></span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  response_rates <span class="op">=</span> <span class="fl">0.45</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"cunanan"</span>,</span>
<span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    r_s <span class="op">=</span> <span class="fl">1</span>,      <span class="co"># Min responses to continue basket (heterogeneous path)</span></span>
<span>    r_c <span class="op">=</span> <span class="fl">5</span>,      <span class="co"># Min total responses to continue (homogeneous path)</span></span>
<span>    n2 <span class="op">=</span> <span class="fl">15</span>,      <span class="co"># Stage 2 sample size per basket</span></span>
<span>    gamma <span class="op">=</span> <span class="fl">0.52</span>, <span class="co"># Heterogeneity threshold</span></span>
<span>    alpha_s <span class="op">=</span> <span class="fl">0.07</span>, <span class="co"># Separate analysis alpha</span></span>
<span>    alpha_c <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># Combined analysis alpha</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stage 1 data</span></span>
<span><span class="va">stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Basket"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interim analysis</span></span>
<span><span class="va">interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">stage1</span>, <span class="va">design_cunanan</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">interim</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cunanan Efficient Basket Trial Design</span></span>
<span><span class="co">#&gt; =====================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; INTERIM ANALYSIS (Stage 1)</span></span>
<span><span class="co">#&gt; --------------------------</span></span>
<span><span class="co">#&gt; Test of Homogeneity p-value: 0.044 </span></span>
<span><span class="co">#&gt; Design path selected: heterogeneous </span></span>
<span><span class="co">#&gt; Baskets continuing to Stage 2: 1, 2, 3, 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Stage 2 will analyze baskets separately with alpha = 0.0175</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simon-two-stage-design-reference-comparator">Simon Two-Stage Design (Reference Comparator)<a class="anchor" aria-label="anchor" href="#simon-two-stage-design-reference-comparator"></a>
</h2>
<p>The Simon design analyzes each basket independently without information borrowing:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Design with parallel Simon designs</span></span>
<span><span class="va">design_simon</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/simon_design.html">simon_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  alternative_response_rates <span class="op">=</span> <span class="fl">0.40</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fl">4</span>,  <span class="co"># Bonferroni correction for FWER control</span></span>
<span>  beta <span class="op">=</span> <span class="fl">0.20</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design_simon</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simon Two-Stage Design (Parallel Independent Designs)</span></span>
<span><span class="co">#&gt; =====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: OPTIMAL </span></span>
<span><span class="co">#&gt;   - optimal: minimizes expected sample size under H0</span></span>
<span><span class="co">#&gt;   - minimax: minimizes maximum sample size</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of cohorts: 4 </span></span>
<span><span class="co">#&gt; Per-cohort error rates:</span></span>
<span><span class="co">#&gt;   - Alpha (type I): 0.0125 </span></span>
<span><span class="co">#&gt;   - Beta (type II): 0.2 </span></span>
<span><span class="co">#&gt;   - Power: 0.8 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cohort specifications:</span></span>
<span><span class="co">#&gt;   NSCLC: n=25, p0=0.200</span></span>
<span><span class="co">#&gt;   SCLC: n=25, p0=0.200</span></span>
<span><span class="co">#&gt;   Melanoma: n=25, p0=0.200</span></span>
<span><span class="co">#&gt;   RCC: n=25, p0=0.200</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: No information borrowing between cohorts.</span></span>
<span><span class="co">#&gt; For FWER control at level epsilon, use alpha = epsilon / n_baskets (Bonferroni).</span></span>
<span></span>
<span><span class="co"># Stage 1 data</span></span>
<span><span class="va">stage1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Basket"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interim analysis (checks futility per basket)</span></span>
<span><span class="va">interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">stage1</span>, <span class="va">design_simon</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">interim</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simon Two-Stage Design (Parallel Independent Analyses)</span></span>
<span><span class="co">#&gt; =======================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: optimal </span></span>
<span><span class="co">#&gt; Alpha: 0.0125 </span></span>
<span><span class="co">#&gt; Beta: 0.2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Parameters:</span></span>
<span><span class="co">#&gt;   Stage 1: n1 = 20, r1 = 4 (stop if &lt;= 4 responses)</span></span>
<span><span class="co">#&gt;   Stage 2: n = 49, r = 16 (reject if &gt; 16 responses total)</span></span>
<span><span class="co">#&gt;   Expected N under H0: 30.7</span></span>
<span><span class="co">#&gt;   Probability of early termination (PET): 0.630</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; INTERIM ANALYSIS (Stage 1)</span></span>
<span><span class="co">#&gt; --------------------------</span></span>
<span><span class="co">#&gt; Baskets continuing to Stage 2: 4 of 4 </span></span>
<span><span class="co">#&gt; Baskets stopped for futility: 0 of 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Basket 1: Continue (6/12 responses)</span></span>
<span><span class="co">#&gt;   Basket 2: Continue (2/12 responses)</span></span>
<span><span class="co">#&gt;   Basket 3: Continue (5/12 responses)</span></span>
<span><span class="co">#&gt;   Basket 4: Continue (1/12 responses)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bayesian-model-averaging-bma">Bayesian Model Averaging (BMA)<a class="anchor" aria-label="anchor" href="#bayesian-model-averaging-bma"></a>
</h2>
<p>The BMA design uses Bayesian model averaging over all possible partitions of baskets, providing flexible, data-driven information borrowing:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># BMA design for 4 baskets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ethan-alt/bmabasket" class="external-link">bmabasket</a></span><span class="op">)</span></span>
<span><span class="va">design_bma</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"bma"</span>,</span>
<span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    mu0 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Prior mean</span></span>
<span>    phi0 <span class="op">=</span> <span class="fl">1</span>,   <span class="co"># Prior dispersion (1 = uninformative)</span></span>
<span>    pmp0 <span class="op">=</span> <span class="fl">1</span>,   <span class="co"># Model prior parameter (1 = default, 0 = uniform)</span></span>
<span>    post_prob_threshold <span class="op">=</span> <span class="fl">0.95</span>  <span class="co"># Posterior prob threshold for efficacy</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design_bma</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Design</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: bma </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Basket Details:</span></span>
<span><span class="co">#&gt;    Basket  N Null_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25       0.2</span></span>
<span><span class="co">#&gt;      SCLC 25       0.2</span></span>
<span><span class="co">#&gt;  Melanoma 25       0.2</span></span>
<span><span class="co">#&gt;       RCC 25       0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Parameters:</span></span>
<span><span class="co">#&gt; $mu0</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $phi0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pmp0</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $post_prob_threshold</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span></span>
<span><span class="co"># Data</span></span>
<span><span class="va">bma_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># BMA analysis</span></span>
<span><span class="va">result_bma</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">bma_data</span>, <span class="va">design_bma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_bma</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bayesian Model Averaging (BMA) Analysis Results</span></span>
<span><span class="co">#&gt; ================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior parameters:</span></span>
<span><span class="co">#&gt;   mu0 (prior mean): 0.5 </span></span>
<span><span class="co">#&gt;   phi0 (prior dispersion): 1 </span></span>
<span><span class="co">#&gt;   pmp0 (model prob parameter): 1 </span></span>
<span><span class="co">#&gt;   P (max distinct params): 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Decision threshold: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Basket Post Mean Post Prob       Decision</span></span>
<span><span class="co">#&gt;     NSCLC     0.340     0.962      REJECT H0</span></span>
<span><span class="co">#&gt;      SCLC     0.433     0.999      REJECT H0</span></span>
<span><span class="co">#&gt;  Melanoma     0.293     0.861 FAIL TO REJECT</span></span>
<span><span class="co">#&gt;       RCC     0.387     0.994      REJECT H0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Baskets rejecting null: 3 of 4</span></span>
<span></span>
<span><span class="co"># Extract rejections</span></span>
<span><span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_rejections.html">extract_rejections</a></span><span class="op">(</span><span class="va">result_bma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  TRUE  TRUE FALSE  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multi-source-exchangeability-model-mem">Multi-source Exchangeability Model (MEM)<a class="anchor" aria-label="anchor" href="#multi-source-exchangeability-model-mem"></a>
</h2>
<p>The MEM design learns the exchangeability structure from the data, borrowing information between similar baskets while protecting against borrowing from dissimilar baskets:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MEM design for 4 baskets</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaneplusplus/basket" class="external-link">basket</a></span><span class="op">)</span></span>
<span><span class="va">design_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  n_baskets <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.20</span>,</span>
<span>  design_type <span class="op">=</span> <span class="st">"mem"</span>,</span>
<span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    shape1 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Beta prior shape parameter 1</span></span>
<span>    shape2 <span class="op">=</span> <span class="fl">0.5</span>,  <span class="co"># Beta prior shape parameter 2</span></span>
<span>    hpd_alpha <span class="op">=</span> <span class="fl">0.05</span>  <span class="co"># HPD credible interval level</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design_mem</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Design</span></span>
<span><span class="co">#&gt; ==================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Type: mem </span></span>
<span><span class="co">#&gt; Number of Baskets: 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Basket Details:</span></span>
<span><span class="co">#&gt;    Basket  N Null_Rate</span></span>
<span><span class="co">#&gt;     NSCLC 25       0.2</span></span>
<span><span class="co">#&gt;      SCLC 25       0.2</span></span>
<span><span class="co">#&gt;  Melanoma 25       0.2</span></span>
<span><span class="co">#&gt;       RCC 25       0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Design Parameters:</span></span>
<span><span class="co">#&gt; $shape1</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $shape2</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hpd_alpha</span></span>
<span><span class="co">#&gt; [1] 0.05</span></span>
<span></span>
<span><span class="co"># Data</span></span>
<span><span class="va">mem_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSCLC"</span>, <span class="st">"SCLC"</span>, <span class="st">"Melanoma"</span>, <span class="st">"RCC"</span><span class="op">)</span>,</span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MEM analysis</span></span>
<span><span class="va">result_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">mem_data</span>, <span class="va">design_mem</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_mem</span><span class="op">)</span></span>
<span><span class="co">#&gt; Multi-source Exchangeability Model (MEM) Analysis Results</span></span>
<span><span class="co">#&gt; =========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Prior parameters:</span></span>
<span><span class="co">#&gt;   shape1 (beta prior): 0.5 </span></span>
<span><span class="co">#&gt;   shape2 (beta prior): 0.5 </span></span>
<span><span class="co">#&gt;   hpd_alpha: 0.05 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Decision threshold (P &gt; p0): 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Basket Post Mean Post Median Post Prob HPD Lower HPD Upper  Decision</span></span>
<span><span class="co">#&gt;     NSCLC     0.361       0.360     0.999     0.256     0.464 REJECT H0</span></span>
<span><span class="co">#&gt;      SCLC     0.372       0.369     1.000     0.267     0.486 REJECT H0</span></span>
<span><span class="co">#&gt;  Melanoma     0.351       0.351     0.994     0.241     0.461 REJECT H0</span></span>
<span><span class="co">#&gt;       RCC     0.363       0.361     0.999     0.262     0.466 REJECT H0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Baskets rejecting null: 4 of 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior Exchangeability Probabilities (PEP):</span></span>
<span><span class="co">#&gt; (Probability that baskets share the same response rate)</span></span>
<span><span class="co">#&gt;          NSCLC  SCLC Melanoma   RCC</span></span>
<span><span class="co">#&gt; NSCLC        1 0.896    0.904 0.955</span></span>
<span><span class="co">#&gt; SCLC        NA 1.000    0.767 0.911</span></span>
<span><span class="co">#&gt; Melanoma    NA    NA    1.000 0.888</span></span>
<span><span class="co">#&gt; RCC         NA    NA       NA 1.000</span></span>
<span></span>
<span><span class="co"># Extract rejections</span></span>
<span><span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_rejections.html">extract_rejections</a></span><span class="op">(</span><span class="va">result_mem</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span>
<span><span class="co">#&gt;    NSCLC     SCLC Melanoma      RCC </span></span>
<span><span class="co">#&gt;     TRUE     TRUE     TRUE     TRUE</span></span></code></pre></div>
<div class="section level3">
<h3 id="bayesian-hierarchical-model-bhm">Bayesian Hierarchical Model (BHM)<a class="anchor" aria-label="anchor" href="#bayesian-hierarchical-model-bhm"></a>
</h3>
<p>BHM methods from Berry et al. (2013) and Neuenschwander et al. (2016) use MCMC to estimate posterior distributions with hierarchical borrowing:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: Requires JAGS installation (https://mcmc-jags.sourceforge.io/)</span></span>
<span><span class="va">design_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_design.html">basket_design</a></span><span class="op">(</span></span>
<span>  design_type <span class="op">=</span> <span class="st">"bhm"</span>,</span>
<span>  n_baskets <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  sample_sizes <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  null_response_rates <span class="op">=</span> <span class="fl">0.15</span>,</span>
<span>  design_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"berry"</span>,              <span class="co"># Options: "berry", "exnex", "exnex_adj", "pooled", "stratified"</span></span>
<span>    n_mcmc_iterations <span class="op">=</span> <span class="fl">10000</span>,     <span class="co"># MCMC iterations</span></span>
<span>    evidence_level <span class="op">=</span> <span class="fl">0.1</span>           <span class="co"># Alpha level for decisions</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bhm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/basket_data.html">basket_data</a></span><span class="op">(</span></span>
<span>  n_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  n_responses <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  basket_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Basket A"</span>, <span class="st">"Basket B"</span>, <span class="st">"Basket C"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result_bhm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_basket.html">analyze_basket</a></span><span class="op">(</span><span class="va">bhm_data</span>, <span class="va">design_bhm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_bhm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract rejections</span></span>
<span><span class="va">rejections</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/extract_rejections.html">extract_rejections</a></span><span class="op">(</span><span class="va">result_bhm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rejections</span><span class="op">)</span></span></code></pre></div>
<p><strong>System Requirements:</strong> BHM analysis requires JAGS (Just Another Gibbs Sampler) to be installed on your system. Download from <a href="https://mcmc-jags.sourceforge.io/" class="external-link uri">https://mcmc-jags.sourceforge.io/</a>. After installing JAGS, install the R package: <code>install.packages("rjags")</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="analyzing-real-data">Analyzing Real Data<a class="anchor" aria-label="anchor" href="#analyzing-real-data"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load included example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"imatinib_trial"</span>, package <span class="op">=</span> <span class="st">"metabasket"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">imatinib_trial</span><span class="op">)</span></span>
<span><span class="co">#&gt; Basket Trial Data</span></span>
<span><span class="co">#&gt; =================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Baskets: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Basket  N Responses Response_Rate</span></span>
<span><span class="co">#&gt;      Angiosarcoma 15         2         0.133</span></span>
<span><span class="co">#&gt;             Ewing 13         0         0.000</span></span>
<span><span class="co">#&gt;      Fibrosarcoma 12         1         0.083</span></span>
<span><span class="co">#&gt;    Leiomyosarcoma 28         6         0.214</span></span>
<span><span class="co">#&gt;       Liposarcoma 29         7         0.241</span></span>
<span><span class="co">#&gt;               MFH 29         3         0.103</span></span>
<span><span class="co">#&gt;      Osteosarcoma 26         5         0.192</span></span>
<span><span class="co">#&gt;             MPNST  5         1         0.200</span></span>
<span><span class="co">#&gt;  Rhabdomyosarcoma  2         0         0.000</span></span>
<span><span class="co">#&gt;          Synovial 20         3         0.150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Patients: 179 </span></span>
<span><span class="co">#&gt; Total Responses: 28 </span></span>
<span><span class="co">#&gt; Overall Response Rate: 0.156</span></span>
<span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="va">summary_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Basket <span class="op">=</span> <span class="va">imatinib_trial</span><span class="op">$</span><span class="va">basket_names</span>,</span>
<span>  N <span class="op">=</span> <span class="va">imatinib_trial</span><span class="op">$</span><span class="va">n_patients</span>,</span>
<span>  Responses <span class="op">=</span> <span class="va">imatinib_trial</span><span class="op">$</span><span class="va">n_responses</span>,</span>
<span>  `Response Rate` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f%%"</span>, </span>
<span>                            <span class="fl">100</span> <span class="op">*</span> <span class="va">imatinib_trial</span><span class="op">$</span><span class="va">n_responses</span> <span class="op">/</span> <span class="va">imatinib_trial</span><span class="op">$</span><span class="va">n_patients</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_df</span>, align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>, <span class="st">"r"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Basket</th>
<th align="right">N</th>
<th align="right">Responses</th>
<th align="right">Response Rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Angiosarcoma</td>
<td align="right">15</td>
<td align="right">2</td>
<td align="right">13.3%</td>
</tr>
<tr class="even">
<td align="left">Ewing</td>
<td align="right">13</td>
<td align="right">0</td>
<td align="right">0.0%</td>
</tr>
<tr class="odd">
<td align="left">Fibrosarcoma</td>
<td align="right">12</td>
<td align="right">1</td>
<td align="right">8.3%</td>
</tr>
<tr class="even">
<td align="left">Leiomyosarcoma</td>
<td align="right">28</td>
<td align="right">6</td>
<td align="right">21.4%</td>
</tr>
<tr class="odd">
<td align="left">Liposarcoma</td>
<td align="right">29</td>
<td align="right">7</td>
<td align="right">24.1%</td>
</tr>
<tr class="even">
<td align="left">MFH</td>
<td align="right">29</td>
<td align="right">3</td>
<td align="right">10.3%</td>
</tr>
<tr class="odd">
<td align="left">Osteosarcoma</td>
<td align="right">26</td>
<td align="right">5</td>
<td align="right">19.2%</td>
</tr>
<tr class="even">
<td align="left">MPNST</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">20.0%</td>
</tr>
<tr class="odd">
<td align="left">Rhabdomyosarcoma</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0.0%</td>
</tr>
<tr class="even">
<td align="left">Synovial</td>
<td align="right">20</td>
<td align="right">3</td>
<td align="right">15.0%</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<div class="section level3">
<h3 id="consistent-interface">Consistent Interface<a class="anchor" aria-label="anchor" href="#consistent-interface"></a>
</h3>
<p>All methods use the same workflow:</p>
<ol style="list-style-type: decimal">
<li>Define design with <code><a href="reference/basket_design.html">basket_design()</a></code> or <code><a href="reference/simon_design.html">simon_design()</a></code>
</li>
<li>Simulate data with <code><a href="reference/simulate_responses.html">simulate_responses()</a></code> or provide real data with <code><a href="reference/basket_data.html">basket_data()</a></code>
</li>
<li>Analyze with <code><a href="reference/analyze_basket.html">analyze_basket()</a></code> (method-specific)</li>
<li>Compute operating characteristics with <code><a href="reference/simulate_basket_trial.html">simulate_basket_trial()</a></code>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="protocol-language-generation">Protocol Language Generation<a class="anchor" aria-label="anchor" href="#protocol-language-generation"></a>
</h3>
<p>Automatically generate standardized protocol text:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">protocol_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/generate_protocol_language.html">generate_protocol_language</a></span><span class="op">(</span></span>
<span>  <span class="va">design</span>,</span>
<span>  include_statistical_details <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_references <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Export to file</span></span>
<span><span class="fu"><a href="reference/export_protocol_language.html">export_protocol_language</a></span><span class="op">(</span><span class="va">design</span>, file <span class="op">=</span> <span class="st">"protocol_section.md"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div class="section level3">
<h3 id="key-papers">Key Papers<a class="anchor" aria-label="anchor" href="#key-papers"></a>
</h3>
<p><strong>Review:</strong> - Zhou T, Ji Y. Bayesian Methods for Information Borrowing in Basket Trials: An Overview. <em>Cancers</em>. 2024;16(2):251. <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10813856/" class="external-link">PMC10813856</a></p>
<p><strong>Methods:</strong> 1. <strong>BMA</strong>: Psioda MA, et al. Bayesian adaptive basket trial design using model averaging. <em>Biostatistics</em>. 2021;22(1):19-34. 2. <strong>MEM</strong>: Hobbs BP, Landin R. Bayesian basket trial design with exchangeability monitoring. <em>Stat Med</em>. 2018;37(25):3557-3572. 3. <strong>EXNEX</strong>: Neuenschwander B, et al. Robust exchangeability designs for early phase clinical trials. <em>Pharm Stat</em>. 2016;15(2):123-134. 4. <strong>BHM</strong>: Berry SM, et al. Bayesian hierarchical modeling of patient subpopulations. <em>Clin Trials</em>. 2013;10(5):720-734. 5. <strong>Cunanan</strong>: Cunanan KM, et al. An efficient basket trial design. <em>Stat Med</em>. 2017;36(10):1568-1579. 6. <strong>Simon</strong>: Simon R. Optimal two-stage designs for phase II clinical trials. <em>Control Clin Trials</em>. 1989;10(1):1-10.</p>
<p><strong>Trial Examples:</strong> - Chugh R, et al. Phase II multicenter trial of imatinib in 10 histologic subtypes of sarcoma. <em>J Clin Oncol</em>. 2009;27(19):3148-3153. - Hyman DM, et al. Vemurafenib in multiple nonmelanoma cancers with BRAF V600 mutations. <em>N Engl J Med</em>. 2015;373(8):726-736.</p>
</div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL (&gt;= 3)</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use this package, please cite:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>Gerke <span class="fu">T</span> (<span class="dv">2024</span>). metabasket<span class="sc">:</span> Unified Framework <span class="cf">for</span> Basket Trial Design and Comparison.</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>R package version <span class="dv">0</span>.<span class="dv">0</span>.<span class="dv">0</span>.<span class="fl">9000.</span> https<span class="sc">:</span><span class="er">//</span>tgerke.github.io<span class="sc">/</span>metabasket</span></code></pre></div>
<p>And cite the original method papers as appropriate.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<ul>
<li>Travis Gerke (<a href="mailto:tgerke@mail.harvard.edu" class="email">tgerke@mail.harvard.edu</a>)</li>
<li>GitHub Issues: <a href="https://github.com/tgerke/metabasket/issues" class="external-link uri">https://github.com/tgerke/metabasket/issues</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tgerke/metabasket/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tgerke/metabasket/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing metabasket</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/tgerke" class="external-link">Travis Gerke</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9500-8907" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tgerke/metabasket/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tgerke/metabasket/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/tgerke/metabasket?branch=main" class="external-link"><img src="https://codecov.io/gh/tgerke/metabasket/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tgerke" class="external-link">Travis Gerke</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
